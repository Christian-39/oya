{% load humanize %}
<!DOCTYPE html>
{% load static %}
<html lang="en">

<head>
	<meta charset="UTF-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<title>Dashboard</title>

	<!-- Fonts & Icons -->
	<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	<link rel="stylesheet" href="{% static 'accounts/css/styles.css' %}">

	<style>
		/* Cards */
		.stats {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
			gap: 14px;
			margin: 16px 0 22px;
		}

		.stat-card {
			background: var(--card);
			border-radius: var(--radius);
			box-shadow: var(--shadow);
			padding: 16px;
			display: flex;
			gap: 12px;
			align-items: center;
		}

		.stat-card i {
			color: var(--primary);
			background: rgba(10, 124, 91, .1);
			padding: 10px;
			border-radius: 10px;
		}

		.grid {
			display: grid;
			grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
			gap: 14px;
		}

		.tile {
			background: var(--card);
			border-radius: var(--radius);
			box-shadow: var(--shadow);
			padding: 16px;
			text-align: center;
			transition: transform .2s, box-shadow .2s;
		}

		.tile:hover {
			transform: translateY(-4px);
			box-shadow: 0 14px 30px rgba(0, 0, 0, .12);
		}

		.tile i {
			color: var(--primary);
			margin-bottom: 6px;
		}

		.tile a {
			text-decoration: none;
			color: var(--text);
			font-weight: 500;
			font-size: 14px;
			display: block;
		}

		.section {
			background: var(--card);
			border-radius: var(--radius);
			box-shadow: var(--shadow);
			padding: 16px;
			margin-top: 18px;
		}

		.projects {
			background: linear-gradient(135deg, #0a7c5b, #0fb38a);
			color: #fff;
			border-radius: var(--radius);
			padding: 18px;
			display: flex;
			align-items: center;
			justify-content: space-between;
			gap: 10px;
		}

		.btn {
			background: #fff;
			color: #0a7c5b;
			border-radius: 10px;
			padding: 10px 14px;
			text-decoration: none;
			font-weight: 600;
			border: none;
			cursor: pointer;
		}

		.close-btn {
			display: none;
			position: absolute;
			top: 14px;
			right: 14px;
			border: none;
			background: rgba(255, 255, 255, 0.15);
			color: #fff;
			border-radius: 8px;
			padding: 6px 10px;
			cursor: pointer;
		}

		@media (max-width: 900px) {
			.main {
				margin-left: 0;
			}

			.sidebar {
				transform: translateX(-100%);
			}

			.sidebar.show {
				transform: translateX(0);
			}

			.hamburger {
				display: inline-flex;
			}

			.close-btn {
				display: inline-flex;
			}
		}

		.welcome-mini strong {
			font-size: 15px;
		}

		.welcome-mini .sub {
			font-size: 12px;
			color: var(--muted);
		}

		.stats a .stat-card:hover {
			transform: translateY(-4px);
			box-shadow: 0 14px 30px rgba(0, 0, 0, .12);
			transition: .2s ease;
		}

		@media (max-width: 640px) {
			body {
				padding: 0;
			}

			.container {
				max-width: 100%;
				border-radius: 0;
				padding: 14px;
			}
		}
	</style>
</head>

<body>

	<!-- Sidebar -->
	<aside class="sidebar" id="sidebar">
		<div class="brand">
			<a href="{% url 'dashboard' %}" style="text-decoration: none;">
				<div class="avatar">{{ member.full_name|slice:":1" }}</div>
			</a>
		</div>
		<strong>welcome, {{ member.full_name }}</strong>
		<div class="sub">
			{% if member.executive_position %}
			<p>Post: {{ member.executive_position }}</p>
			{% endif %}
		</div>

		<button class="close-btn" onclick="toggleSidebar()">
			<i class="fa fa-times"></i>
		</button>

		<nav class="menu">
			<a href="{% url 'dashboard' %}"><i class="fa fa-home"></i> Home</a>
			<a href="{% url 'contributions_list' %}"><i class="fa fa-wallet"></i> Contributions</a>
			<a href="{% url 'donation_list' %}"><i class="fa fa-plus"></i> Donations</a>
			<a href="{% url 'executives_list' %}"><i class="fa fa-users"></i> Executives</a>
			<a href="{% url 'taskforce_list' %}"><i class="fa fa-user-shield"></i> Task Force</a>
			<a href="{% url 'motorcycles_list' %}"><i class="fa fa-motorcycle"></i> Motorcycles</a>
			<a href="{% url 'cases_list' %}"><i class="fa fa-folder-open"></i> Community Cases</a>
			<a href="{% url 'projects_list' %}"><i class="fa fa-diagram-project"></i> Projects</a>
			{% if request.session.member_role == 'admin' %}
			<a href="{% url 'admin_dashboard' %}"><i class="fa fa-user-cog"></i> Admin Panel</a>
			{% endif %}
		</nav>
	</aside>

	<!-- Main -->
	<main class="main">
		<!-- Topbar -->
		<div class="topbar">
			<div class="left-top">
				<button class="hamburger" onclick="toggleSidebar()">
					<i class="fa fa-bars"></i>
				</button>

				<div class="brand">
					<img src="{% static 'accounts/images/oya logo.jpeg' %}" alt="OYA Logo">
					<span>
						OYA<br>
						<small>Peace & Progress</small>
					</span>
				</div>
			</div>

			<div class="actions">

				<!-- Notifications / Profile Trigger -->
				<div class="profile" onclick="toggleProfile()">
					<span class="badge-noty">
						{{ announcements_count|add:minutes_count }}
					</span>
					<i class="fa fa-cog"></i>
				</div>

				<!-- Dropdown -->
				<div class="dropdown" id="profileDrop">
					<p>
						<i class="fa fa-user-circle"></i>
						<strong>{{ member.full_name }}</strong>
					</p>

					<button class="icon-btn" onclick="toggleDark()">
						<i class="fa fa-moon"></i>
						Dark Mode
					</button>

					<a href="{% url 'member_profile' member.id %}">
						<i class="fa fa-id-badge"></i>
						My Profile
					</a>

					<a href="{% url 'announcements_list' %}">
						<i class="fa fa-bullhorn"></i>
						Announcements ({{ announcements_count }})
					</a>

					<a href="{% url 'minutes_list' %}">
						<i class="fa fa-file-lines"></i>
						Minutes ({{ minutes_count }})
					</a>

					<a href="#" onclick="window.print()">
						<i class="fa fa-print"></i>
						Print Report
					</a>

					<a href="{% url 'logout' %}">
						<i class="fa fa-right-from-bracket"></i>
						Logout
					</a>
				</div>

			</div>
		</div>


		<!-- Stats -->
		<!-- Stats -->
		<section class="stats">
			<div class="stat-card">
				<i class="fa fa-users"></i>
				<div>
					<small>Total Members</small>
					<div><strong>{{ total_members|default:"0" }}</strong></div>
				</div>
			</div>

			<!-- Total Income -->
			<a href="{% url 'income_list' %}" style="text-decoration:none; color:inherit;">
				<div class="stat-card">
					<i class="fa fa-wallet"></i>
					<div>
						<small>Total Income</small>
						<div>
							<strong>₦{{ total_money|intcomma|default:"0" }}</strong>
						</div>
					</div>
				</div>
			</a>

			<!-- Total Income -->
			<a href="{% url 'contributions_list' %}" style="text-decoration:none; color:inherit;">
				<div class="stat-card">
					<i class="fa fa-wallet"></i>
					<div>
						<small>Total yearly dues</small>
						<div>
							<strong>₦{{ total_contributions|intcomma|default:"0" }}</strong>
						</div>
					</div>
				</div>
			</a>

			<!-- Total Income -->
			<a href="{% url 'donation_list' %}" style="text-decoration:none; color:inherit;">
				<div class="stat-card">
					<i class="fa fa-wallet"></i>
					<div>
						<small>Total Donations</small>
						<div>
							<strong>₦{{ total_income|intcomma|default:"0" }}</strong>
						</div>
					</div>
				</div>
			</a>

			<!-- Total Expenses -->
			<a href="{% url 'expenses_list' %}" style="text-decoration:none; color:inherit;">
				<div class="stat-card">
					<i class="fa fa-money-bill-wave"></i>
					<div>
						<small>Total Expenses</small>
						<div>
							<strong>₦{{ total_expenses|intcomma|default:"0" }}</strong>
						</div>
					</div>
				</div>
			</a>

			<!-- Net Balance -->
			<div class="stat-card">
				<i class="fa fa-scale-balanced"></i>
				<div>
					<small>Net Balance</small>
					<div>
						<strong>
							₦{{ net_balance|intcomma|default:"0" }}
						</strong>
					</div>
				</div>
			</div>

			<div class="stat-card">
				<i class="fa fa-motorcycle"></i>
				<div>
					<small>Motorcycles</small>
					<div><strong>{{ total_motorcycles|default:"0" }}</strong></div>
				</div>
			</div>

			<div class="stat-card">
				<i class="fa fa-folder-open"></i>
				<div>
					<small>Community Cases</small>
					<div><strong>{{ total_cases|default:"0" }}</strong></div>
				</div>
			</div>
		</section>


		<!-- Quick Links -->
		<section class="grid">
			<div class="tile"><a href="{% url 'my_contributions' %}"><i class="fa fa-wallet"></i></a><a
					href="{% url 'my_contributions' %}">My Contributions</a></div>
			{% if member.role == 'admin' %}
			<div class="tile"><a href="{% url 'contributions_list' %}"><i class="fa fa-cog"></i></a><a
					href="{% url 'contributions_list' %}">Manage dues</a></div>
			{% endif %}
			<div class="tile"><a href="{% url 'executives_list' %}"><i class="fa fa-users"></i></a><a
					href="{% url 'executives_list' %}">Executives</a></div>
			<div class="tile"><a href="{% url 'taskforce_list' %}"><i class="fa fa-user-shield"></i></a><a
					href="{% url 'taskforce_list' %}">Task Force</a></div>
			<div class="tile"><a href="{% url 'motorcycles_list' %}"><i class="fa fa-motorcycle"></i></a><a
					href="{% url 'motorcycles_list' %}">Motorcycles</a></div>
			<div class="tile"><a href="{% url 'members_list' %}"><i class="fa fa-folder-open"></i></a><a
					href="{% url 'members_list' %}">Members lists</a></div>
		</section>

		<!-- Chart -->
		<section class="section">
			<h3>Monthly Contributions</h3>
			<canvas id="contribChart" height="120"></canvas>
		</section>

		<!-- Projects -->
		<section class="projects">
			<div>
				<h3>Projects</h3>
				<p>See ongoing, completed & future projects</p>
			</div>
			<a href="{% url 'projects_list' %}" class="btn">View Projects</a>
		</section>
	</main>
	<script src="{% static 'accounts/js/scripts.js' %}"></script>


</body>

</html>